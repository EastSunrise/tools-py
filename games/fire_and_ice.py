#!/usr/bin/env python
# -*- encoding: utf-8 -*-
"""
@Description A Dance of Fire and Ice
@Author Kingen
@Date 2020/3/15
"""
import time

from pykeyboard import PyKeyboard


class FireAndIce:
    """
    A Dance of Fire and Ice
    """

    # data [ready, w0, dws] for level x.x
    # 'ready' is time to get ready.
    # 'w0' is the initial angular speed, degrees/second.
    # 'dws' is the data of every block, the degree of angle if the angular speed doesn't change
    #  or tuple of the degree and the change of the speed instead.
    LEVEL_DATA = [
        [
            2.3, 452,
            [
                180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 270, 90, 180, 180, 180, 180, 180, 180,
                180, 180, 180, 180, 180, 180, 180, 180, 270, 90, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 180, 180, 180, 180, 270, 90, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 180, 90, 270, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 90,
                270, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 90, 270, 90, 270, 180, 180,
                180, 180, 180, 180, 180, 180, 270, 90, 270, 90, 270, 90, 270, 90, 180, 180, 180, 180, 180, 180,
                180, 180, 180, 180, 180, 180, 90, 270, 90, 270, 180, 180, 180, 180, 180, 180, 180, 180, 270, 90,
                270, 90, 180, 180, 90, 270, (180, 0.25), 180, 180, 180, 180, 180, 180
            ]
        ],
        [
            2.1, 480,
            [
                180, 180, 180, 270, 180, 180, 180, 90, 180, 180, 180, 270, 180, 180, 180, 90, 180, 180, 180, 270,
                180, 180, 180, 90, 180, 180, 180, 180, 90, 180, 180, 270, 180, 180, 180, 270, 180, 180, 180, 90,
                180, 180, 180, 270, 180, 180, 180, 90, 180, 180, 180, 270, 180, 180, 180, 90, 180, 180, 180, 90,
                180, 180, 180, 270, (180, 0.25), 180, 180, 180, (180, 2), 180, 180, 180, (180, 2.01), 180, 180, 180,
                180, 180, 180, 180, 90, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 90, 180, 180, 180,
                270, 180, 180, 180, 90, 180, 180, 180, 270, 180, 180, 180, 90, 180, 180, 180, 270, 180, 180, 180,
                90, 180, 180, 180, 180, 90, 180, 180, 180
            ]
        ],
        [
            1.96, 542.2,
            [
                180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 270, 270, 180, 180, 180, 180, 180, 180, 180,
                90, 90, 180, 180, 180, 180, 180, 180, 180, 180, 180, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90,
                90, 180, 180, 180, 180, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 180, 180, 180, 180, 90,
                270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90,
                90, 270, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 270, 270, 90, 90, 180, 180, 180, 180,
                270, 270, 90, 90, 180, 180, 180, 180, 270, 270, 90, 90, 180, 180, 180, 180, 270, 270, 90, 90, 180, 90,
                270, 180, 270, 270, 90, 90, 180, 90, 270, 180, 270, 270, 90, 90, 180, 90, 270, 180, 270, 270, 90, 90,
                180, 90, 270, 180, 270, 270, 180
            ]
        ],
        [
            3.5, 255,
            [
                120, 240, 180, 180, 120, 240, 180, 180, 120, 240, 180, 180, 120, 240, 180, 180, 120,
                120, 270, (180, 0.97), 120, 120, 270, (180, 0.98), 120, 120, 270, 180, 120, 120, 270,
                180, 180, 120, 120, 90, 180, (180, -1), 240, 240, 270, 180, (180, -1), 120, 120, 90,
                180, (180, -1.03), 240, 240, 270, 180, (180, -1), 120, 120, 90, 180, (180, -1), 240,
                240, 270, 180, (180, -0.97), 120, 120, 90, 180, (180, -1), 240, 240, 90,
                (180, 1.02), 300, 300, 240, 270, 180, 180, 300, 300, 240, 270, 180,
                (180, 0.98), 300, 300, 240, 270, 180, 180, 300, 300, 240, 270, 180,
                180, 300, 300, 240, 270, 180, (180, 1.02), 300, 300, 240, 270, 180,
                180, 300, 300, 240, 270, 180, 180, 300, 300, 240, 270, 180,
                (180, 0.26), 180, 180, 180, (90, 2), 260, 90, 270, 180, 180,
                (180, 2), 180, 180, 180, (180, 0.97), 240, 120, 180, 180, 240, 240, 270, 180,
                (180, -0.98), 120, 120, 90, 180, (180, -1), 240, 240, 270, 270, 270, 180,
                240, 120, 180, (180, 1.04), 240, 120, 180, 180, 240, 240, 270, 180,
                (180, -1), 120, 240, 90, 90, 180
            ]
        ],
        [
            2.1, 512,
            [
                180, 180, 180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 120, 240, 180, 180,
                180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 300, 60, 180, 180,
                180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 300, 60, 180, 180,
                180, 180, 180, 180, 180, 180, 300, 180, 60, 180,
                180, 180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 120, 240, 180, 180,
                180, 120, 180, 240, 180, 180, 300, 60, 180, 180,
                180, 120, 180, 240, 180, 180, 300, 60, 180, 180,
                180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 120, 60, 120, 180, 60, 180,
                180, 180, 180, 180, 180, 180, 180, 300, 180, 60, 180, 180,
                180, 120, 180, 240, 180, 180, 120, 180, 240, 180,
                180, 120, 180, 240, 180, 180, 120, 180
            ]
        ],
        [
            2, 527,
            [
                180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 90, 90, 90, 90, 180, 180, 180, 180, 180, 180, 180, 180, 90, 90, 270, 180, 270, 180,
                180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180,
                270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90,
                270, 180, 270, 180, 180, 90, 90, 270, 180, 180, 90, 180, 180, 90, 90, 270, 180, 270, 180,
                180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180,
                270, 180, 270, 90, 270, 90, 270, 90, 270, 90, 270, 90, 270, 90, 270, 90, 270, 90, 180,
                90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 90, 270, 90, 270, 90, 270,
                90, 270, 90, 270, 90, 270, 90, 270, 90, 270, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90,
                270, 180, 270, 180, (180, 0.5), 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180, 180,
                180, 180, 180, (180, 2), 90, 180, 180, 180, 180, 270, 180, 180, 90, 180, 180, 180, 180, 180,
                90, 90, 90, 180, 90, 180, 180, 180, 180, 270, 180, 180, 90, 180, 180, 180, 180, 180, 90, 90,
                90, 180, 180, 90, 270, 180, 180, 90, 270, 180, 180, 90, 270, 180, 180, 90, 270, 180, 180, 90,
                270, 180, 180, 90, 270, 180, 180, 90, 180, 270, 180, 180, 270, 90, 90, 270, 270, 90, 90, 270,
                270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 270, 270, 90, 90, 270, 90, 90, 270, 180, 270,
                180, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270,
                180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90, 270, 180, 270, 180, 180, 90, 90,
                90, 180, 180, 180, 90, 180, 180, 90, 90, 90, 180, 180, 180, 90, 180, 180, 90, 90, 90, 180,
                180, 180, 90, 180, 180, 90, 90, 270, 180, 270, 180, 180
            ]
        ],
        [
            2.1, 481,
            [
                270, 270, (90, -1), 90, 180, 180, (270, -1), 270, (90, -1), 90, 180,
                180, (270, -1), 270, (90, -1), 90, 180, 270, 270, 90, 90, (270, -1), 270, 90, 270,
                180, 180, 180, 180, 180, 180, 270, 270, 270, 270,
                180, 180, 180, 180, 180, 180, 270, 270, 270, 270,
                180, 180, 180, 90, 90, 90, 90,
                180, 180, 180, 90, 90, 90, 90,
                180, 180, 180, 90, 180, 180, 90,
                180, 180, 180, (180, 0.333333), (180, 3), 180, 180, 180, 180, 180, 270, 270, (90, -1), 90,
                180, 180, 180, 180, 180, 180, (270, -1), 270, (90, -1), 90,
                180, 270, 270, 270, 270, 180, 180, 180,
                180, 270, 270, 270, 270, 180, 180,
                180, 270, 270, 270, 270, 270, 180, 180,
                180, 270, 270, 270, 270, 180, 270, (180, 0.3333333), (90, 3), 90, (270, -1), 270,
                (180, 1.005), 90, 90, 270, 270, (90, -1), 90,
                180, 270, 270, 90, 90, (270, -1), 270,
                180, 90, 90, 270, 270, (90, -1), 90,
                270, 90, (270, -1), 270, (90, -1), 90,
                180, 270, 270, 90, 90, (270, -1), 270,
                180, 90, 90, 270, 270, (90, -1), 90,
                180, 270, 270, 90, 90, (270, -1), 270, 180,
                180, 270, 270, 270, 180, 180, 270, 270, 270, 270, 180, 270,
                180, 180, 180, 270, 270, (90, -1), 90, (270, -1), 270, 180,
            ]
        ]
    ]

    @staticmethod
    def run(level):
        """
        Start the specific level.
        :param level
        :return:
        """
        data = FireAndIce.LEVEL_DATA[level - 1]
        intervals = [5, data[0]]
        w = data[1]
        for dw in data[2]:
            if isinstance(dw, tuple):
                w *= dw[1]
                d = dw[0]
            else:
                d = dw
            if w < 0:
                intervals.append((360 - d) / (-w))
            else:
                intervals.append(d / w)
        keyboard = PyKeyboard()
        for i, interval in enumerate(intervals):
            keyboard.tap_key(keyboard.space_key)
            print("{} sleep {} s".format(i, interval))
            time.sleep(interval)
